server {
    listen 80;
    # gzip config
    gzip on;
    gzip_min_length 1k;
    gzip_comp_level 9;
    gzip_types text/plain text/css text/javascript application/json application/javascript application/x-javascript application/xml;
    gzip_vary on;
    gzip_disable "MSIE [1-6]\.";

    root /usr/share/nginx/html;
    include /etc/nginx/mime.types;

    location / {
        rewrite ^/  /dashboard redirect;
    }

    location /dashboard {
        try_files $uri $uri/ /index.html;
    }

    # reserve proxy for apisix gateway
    # use X-ADMIN-API-SCHEMA X-ADMIN-API-HOST X-ADMIN-API-PATH X-ADMIN-API-KEY headers to dynamic change proxy params
    location /api/
    {
        proxy_pass $http_x_admin_api_schema://$http_x_admin_api_host;
        proxy_set_header Host $http_x_admin_api_host;
        proxy_set_header X-API-KEY $http_x_admin_api_key;
        rewrite  ^/api/(.*)$ $http_x_admin_api_path$1 break;
    }
}
